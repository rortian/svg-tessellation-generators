#!/usr/bin/env ruby

require 'nokogiri'

require 'pry'

html = Nokogiri::XML::Builder.new do 

  html do
    head do
      title "pg"
    end
    body do
      svg do
        defs do
          g :id => "half" do
            path :fill => "rgb(255,182,110)", :d => "M 73.928572,48.076467 C 12.054086,36.25515 89.475185,62.172711 77.5,74.147895 69.430636,82.21726 36.074591,73.797077 46.071429,93.790753 53.627703,108.9033 76.064668,80.394515 85.714286,85.219324 c 3.991203,1.995602 -6.134061,11.218684 -2.142857,13.214286 25.241001,12.6205 4.694856,-25.149148 4.285714,-26.785715 -4.393974,-17.575894 24.154137,7.951133 17.857147,-4.642857 -2.50875,-5.017495 -20.000004,-14.662823 -20.000004,-16.785714 0,-25.133401 26.891604,7.103397 21.428574,-9.285714 C 102.29935,26.403083 91.83046,38.121212 82.5,28.790752 78.200978,24.491731 109.97719,19.850778 94.285714,12.005038 87.381459,8.5529102 54.40392,7.3647061 52.142857,14.147895 c -8.417939,25.253817 21.835475,7.753213 25.714286,13.571429 3.03094,4.54641 -6.304927,15.366795 -3.928571,20.357143 z"
            path :fill => "rgb(193,173,121)", :d => "M 41.071429,70.219324 C 34.733576,54.7227 40.146912,22.509093 29.642857,12.005038 19.328593,1.690774 13.27483,29.565582 18.214286,34.505038 c 1.641456,1.641457 13.599098,17.115188 10,20.714286 -3.675821,3.67582 -11.339268,3.124982 -15,6.785714 -10.242874,10.242874 17.987431,13.44114 10.714285,20.714286 -5.738068,5.738069 -20.0441881,17.411626 -12.5,32.499996 14.736778,29.47356 18.139713,-16.108711 25.357143,-12.5 5.217316,2.60866 11.737881,43.61927 26.428572,28.92858 5.474749,-5.47475 -18.711762,-25.14034 -21.071429,-27.5 C 28.966368,90.971406 43.671561,74.552878 41.071429,70.219324 z"
            path :fill => "rgb(80,69,57)", :d => "m 29.285714,134.86218 c -3.182593,-6.29955 -22.6608753,5.09813 -15,8.92857 C 35.59343,154.44461 133.0578,170.77712 80,117.71932 c -4.58946,-4.58946 36.67501,6.56431 27.85714,-11.07142 -1.66177,-3.32355 -28.744302,-1.07143 -33.214283,-1.07143 -6.281011,0 -4.606438,21.46499 -0.357143,25.71428 1.511984,1.51199 16.715851,4.92753 12.857143,7.5 -13.569295,9.0462 -41.856248,0.43531 -57.857143,-3.92857 z"
          end
          g :id => "tile" do
            use :"xlink:href" => "#half"
            use :"xlink:href" => "#half", :transform => "translate(0,80) matrix(1,0,0,-1,0,0) translate(120,-80)"
          end
        end
        x1, y1 = 240,0
        x2, y2 =  0,160
        ((0)..2).each do |m|
          ((0)..2).each do |n|
            x_delta = m*x1 + n*x2
            y_delta = m*y1 + n*y2
            use :"xlink:href" => "#tile",:transform => "translate(#{x_delta},#{y_delta})"
          end
        end
      end
    end
  end

end

out = File.new('output.html','w')
out.puts html.doc.to_html
out.close
